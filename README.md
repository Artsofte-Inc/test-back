# Тестовое задание на вакансию back-end developer

Обязательно использовать фрэймворк Net Core последней версии, язык программирования C#.

Нормальный срок выполнения всего тестового задания, с учётом занятости кандидата 7 дней, если срок превышен, то на собеседовании нужно рассказать почему.
В задание могут встречаться ссылки на домен приложения http://localhost:5000, это домен, на котором локально запускается ваше приложение, вы можете использовать любой другой порт. 

## # Задание

###### 1. Создать приложение net core. Общие пожелания:
  - Модель данных User (пользователь, который регистрируется и потом авторизуется) содержит поля:

    | Поле | Назначение | Тип данных | Уникально |
    | :---: | :---: | :---: | :---: |
    | Id | Идентификатор | int | Да |
    | FIO | ФИО | String | Нет |
    | Phone | Номер телефона | String | Да |
    | Email | Email | String | Да |
    | Password | Пароль | String | Нет |
    | LastLogin | Дата последней авторизации | DateTime | Нет |  
    
  - Должна быть возможность хранить пользователей в базе данных или в памяти приложения (например, в коллекции List). Какое именно использовать хранилище определяется при старте приложения (Startup.cs). Необходимо вынести это в настройки, для задания junior достаточно реализовать только вариант с хранением в памяти приложения.
  - Доступ к хранилищу данных, должен осуществляться через интерфейсы (например IUserRepository).
  - Доступ к функционалу приложения должен быть представлен в двух вариантах (бизнес логика должна быть вынесена в общие классы).
    + Через REST API (ApiController-ы которые находятся в отдельном Areas).
    + Через стандартные MVC html-странички razor-шаблонизатора (обычные Controller-ы).
  - Контроллеры должны находиться в проекте Api.csproj, бизнес логика в проекте Logic.csproj.
###### 2. Реализовать функционал регистрации
Необходим для добавления пользователя в систему и в последующей его авторизации.
###### 2.1. Реализация через HTML-страницы
  - Методы для генерации html-страниц регистрации поместить в AccountController и унаследовать его от Controller.
  - Открывать страницу регистрации по ссылке http://localhost:5000/account/register
  - Бизнес логику вынести в класс AccountManager, внедрять его в контроллер через Dependency Injection.
  - Шаблон cshtml для razor.
  - Шаблон содержит форму с полями (валидация на стороне сервера):

    | Поле | Название | Тип данных | Обязательно | Уникально | Длина | Валидатор |
    | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
    | FIO | ФИО | строка | Да | Нет | 250 | - |
    | Phone | Номер телефона | строка | Да | Да | 11 | Только цифры, начинается с "7" |
    | Email | Email | строка | Да | Да | 150 | Валидация для email |
    | Password | Пароль | строка | Да | Нет | 20 | - |
    | PasswordConfirm | Подтверждение пароля | строка | Да | Нет | 20 | должно совпадать с полем Password | 
    
  - Если какие-то из полей не прошли валидацию, то необходимо подсветить их красным и написать ошибку под соответствующим полем.
  - Если пользователь с указанным email или номером телефона уже есть в системе, то не разрешать регистрацию.
  - После успешной регистрации, показывать страницу с текстом "Поздравляем %FIO%, вы стали пользователем системы !" и с одной ссылкой, которая ведёт на страницу авторизации http://localhost:5000/account/login .
###### 2.2. Реализация через REST API
  - Создать контроллер AccountApiController, унаследовать его от ControllerBase и разместить его в Areas проекта Api.csproj.
  - Endpoint должен быть http://localhost:5000/api/account/register
  - REST на регистрацию пользователя ожидает на вход модель (RegisterRequest) и имеет тип POST:
  
    | Поле | Название | Тип данных | Обязательно | Уникально | Длина | Валидатор |
    | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
    | FIO | ФИО | строка | Да | Нет | 250 | - |
    | Phone | Номер телефона | строка | Да | Да | 11 | Только цифры, начинается с "7" |
    | Email | Email | строка | Да | Да | 150 | Валидация для email |
    | Password | Пароль | строка | Да | Нет | 20 | - |
    | PasswordConfirm | Подтверждение пароля | строка | Да | Нет | 20 | должно совпадать с полем Password | 
    
  - В контроллере AccountApiController использовать AccountManager из п. 2.1.
  - Если регистрация прошла успешно, то с сервера должен приходить 200-ый статус ответа, с пустым телом ответа.
  - Если в процессе регистрации пользователя возникли ошибки (пользователь уже зарегистрирован), то возвращать 400-ый статус ответа и модель (ErrorResponse) состоящую из полей:
 
    | Поле | Название | Тип данных | Уникально |
    | :---: | :---: | :---: | :---: |
    | Code | Код ошибки | строка | да |
    | Message | Расшифровка кода ошибки | строка | да |
  
  - Ошибку валидации входной модели (ModelState) оставить в том виде, в котором возвращает её net core.  
###### 3. Реализовать функционал авторизации
Необходим для того что бы сервер выдавал авторизационную сессию пользователю.
###### 3.1. Реализация через HTML-страницы
  - Методы для генерации html-страниц авторизации поместить в AccountController и унаследовать его от Controller.
  - Открывать страницу автроризации по ссылке http://localhost:5000/account/login
  - Бизнес логику вынести в класс AccountManager, внедрять его в контроллер через Dependency Injection.
  - Шаблон cshtml для razor.
  - Шаблон содержит форму с полями (валидация на стороне сервера):

    | Поле | Название | Тип данных | Обязательно | Длина | Валидатор |
    | :---: | :---: | :---: | :---: | :---: | :---: |
    | Phone | Номер телефона | строка | Да | 11 | Только цифры, начинается с "7" |
    | Password | Пароль | строка | Да | 20 | - |

  - Если авторизация не выполняется: не найден номер телефона, не верный пароль или что-то другое - то поле "номер телефона" необходимо подсветить красным и добавить ошибку валидации с текстом "Ошибка авторизации".
  - На страницу авторизации добавить ссылку на страницу регистрации.
  - Если авторизация выполнилась корректно, перенаправить пользователя на страницу http://localhost:5000/cabinet. Без успешной авторизации к странице http://localhost:5000/cabinet доступ закрыт.
  - Без авторизованной сессии пользователь не может попасть в http://localhost:5000/cabinet 
###### 3.2. Реализация через REST API
  - Создать контроллер AccountApiController и унаследовать его от ControllerBase и разместить его в Areas проекта Api.csproj.
  - Endpoint должен быть http://localhost:5000/api/account/login
  - REST на авторизацию пользователя ожидает на вход модель (LoginRequest) и имеет тип POST:

    | Поле | Название | Тип данных | Обязательно | Длина | Валидатор |
    | :---: | :---: | :---: | :---: | :---: | :---: |
    | Phone | Номер телефона | строка | Да | 11 | Только цифры, начинается с "7" |
    | Password | Пароль | строка | Да | 20 | - |
    
  - В контроллере AccountApiController использовать AccountManager из п. 3.1.
  - Если авторизация прошла успешно, то с сервера должен приходить 200-ый статус ответа. Возможны 2 варианта выдачи авторизованной сессии: заголовок Set-Cookies или выдача токена. Реализовать любой из вариантов. 
  - Без авторизованной сессии, пользователь не может выполнить рест http://localhost:5000/api/account/get-my-info и http://localhost:5000/api/accpunt/logout
  - Если в процессе авторизации пользователя возникли ошибки (пользователь уже зарегистрирован), то возвращать 400-ый статус ответа и модель (ErrorResponse) состоящую из полей:
 
    | Поле | Название | Тип данных | Уникально |
    | :---: | :---: | :---: | :---: |
    | Code | Код ошибки | строка | да |
    | Message | Расшифровка кода ошибки | строка | да |
  
  - Ошибку валидации входной модели (ModelState) оставить в том виде, в котором возвращает её Net Core. 
###### 4. Функционал авторизованной зоны
Основная задача отображения информации об авторизованном пользователе. Возможность закончить авторизац
###### 4.1. Реализация через HTML-страницы
  - Методы для генерации html-страниц детальной информации о пользователе поместить в CabinetController и унаследовать его от Controller.
  - Открывать страницу с детальной информацией о пользователе по ссылке http://localhost:5000/cabinet
  - Шаблон cshtml для razor.
  - На страницу вывести поля: 

    | Поле | Название |
    | :---: | :---: |
    | FIO | ФИО пользователя |
    | Phone | Номер телефона |
    | Email | Email |
    | LastLogin | Дата последней авторизации |
    
  - На страницу с детальной информацией добавить кнопку "Выход". После клика по ней разлогинивать пользователя и редиектить на http://localhost:5000/api/account/login
###### 4.2. Реализация через REST API
  - Добавить в AccountApiController два endpoint http://localhost:5000/api/account/get-my-info и http://localhost:5000/api/accpunt/logout 
  - http://localhost:5000/api/accpunt/logout - убивает авторизованную сессию текущего пользователя
  - http://localhost:5000/api/account/get-my-info - возвращает детальную информацию о пользователе
  - REST на авторизацию пользователя ожидает на вход модель (LoginRequest) и имеет тип POST:

    | Поле | Название | Тип данных |
    | :---: | :---: | :---: |
    | FIO | ФИО пользователя | string |
    | Phone | Номер телефона | string |
    | Email | Email | string |
    | LastLogin | Дата последней авторизации | DateTime |

